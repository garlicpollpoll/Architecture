# CAS로 SSO 구현하기

## System Architecture
<img src="https://github.com/garlicpollpoll/Architecture/assets/86602266/c046f6a5-6b8b-48bc-83e2-15cd4fde9788">

자바진영 SSO오픈소스인 CAS를 이용해 애플리케이션을 구현하고 설계하였습니다. 

사내에서 여러개의 서비스를 하나의 로그인으로 묶어야하는 상황에서 SSO를 알아보게 되었고 제가 리드하여 CAS를 구현하여 적용하였습니다. 

과정에서 CAS에 대한 흐름과 아키텍처에 대한 이해를 기반으로 성공적으로 사내 서비스에 적용할 수 있었습니다. 

## 느낀점
CAS의 인증 중 데이터베이스 기반 인증을 선택하였는데 처음에 query[0] 이렇게 써있는 것을 보고 직관적으로 query[1], query[2] 이런식으로 모든 데이터베이스에 찔러보고 없으면 다음 인증정책으로 넘어가겠구나 싶어서 이것 때문에 삽질을 좀 했습니다. 

CAS의 인증 정책은 체인처럼 연결되어있는데 하나의 인증이 실패하면 다음 체인으로 넘어가기 때문에 query[0]에서 사용자가 존재하지 않는 경우 query[1]로 넘어가지 않고 바로 다음 인증으로 넘어갑니다. 

이는 저희 서비스에서 각각의 애플리케이션이 다른 데이터베이스를 바라보고 있어 인증을 위해 여러개의 데이터베이스에서 사용자를 검색해봐야 하는 문제에 봉착하였습니다. 

이 문제 때문에 여러개의 데이터베이스에 있는 사용자 정보를 CAS 인증을 위한 데이터베이스 하나에 마이그레이션하여 데이터베이스 기반 인증을 완료할 수 있었습니다. 

총 세개의 서비스를 하나의 로그인으로 묶어 사용자 경험을 66퍼센트 증가시켰습니다. 

## 블로그
- (SSO구현하기)[https://coding-review.tistory.com/475]
- 
